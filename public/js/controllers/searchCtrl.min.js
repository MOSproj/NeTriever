(function(){angular.module("myApp").controller("searchCtrl",["$scope","$routeParams","$location","$log","categoriesSrv",a]);function a(d,g,h,f,e){var c=this;var b=h.search();c.categoryId=g.categoryId;e.getCategory(c.categoryId).then(function(i){console.log(i.data);console.log(b);c.category=i.data;c.specRange={};c.specselect={};angular.forEach(c.category.specs,function(k,j){if(angular.isArray(k)){c.specselect[j]={data:k,selected:[]};if(j in b){c.specselect[j]["selected"]=b[j]}}else{c.specRange[j]={min:null,max:null};if(j in b){if(parseFloat(b[j].split(",")[0])>=0){c.specRange[j]["min"]=parseFloat(b[j].split(",")[0])}if(parseFloat(b[j].split(",")[1])>=0){c.specRange[j]["max"]=parseFloat(b[j].split(",")[1])}}}})});c.specselectSettings={enableSearch:true,scrollable:true,showCheckAll:false,showUncheckAll:false,keyboardControls:true,smartButtonMaxItems:5,template:"{{ option }}",smartButtonTextConverter:function(j,i){return i}};c.search=function(){var i={};angular.forEach(c.specselect,function(k,j){if(k.selected.length>0||j in b){i[j]=k.selected}});angular.forEach(c.specRange,function(k,j){if((angular.isNumber(k.min)&&k.min>=0)||(angular.isNumber(k.max)&&k.max>=0)){i[j]="";if(angular.isNumber(k.min)&&k.min>=0){i[j]+=k.min}else{i[j]+="-1"}i[j]+=",";if(angular.isNumber(k.max)&&k.max>=0){i[j]+=k.max}else{i[j]+="-1"}}else{if(j in b){delete b[j]}}});angular.extend(b,i);h.path(h.path()).search(b)}}})();