(function(){angular.module("myApp").controller("searchCtrl",["$scope","$routeParams","$location","$log","categoriesSrv",a]);function a(d,g,h,f,e){var c=this;var b=h.search();c.categoryId=g.categoryId;e.getCategory(c.categoryId).then(function(i){f.debug(i.data);c.category=i.data;c.specRange={};c.specselect={};angular.forEach(c.category.specs,function(k,j){if(angular.isArray(k)){c.specselect[j]={data:k,selected:[]};if(j in b){c.specselect[j]["selected"]=b[j]}}else{c.specRange[j]={min:k.split("-")[0],max:k.split("-")[1],model_min:k.split("-")[0],model_max:k.split("-")[1]};if(j in b){c.specRange[j]["model_min"]=parseInt(b[j].split("-")[0]);c.specRange[j]["model_max"]=parseInt(b[j].split("-")[1])}}})});c.specselectSettings={scrollable:true,showCheckAll:false,showUncheckAll:false,keyboardControls:true,smartButtonMaxItems:5,template:"{{ option }}",smartButtonTextConverter:function(j,i){return i}};c.search=function(){var i={};angular.forEach(c.specselect,function(k,j){if(k.selected.length>0){i[j]=k.selected}if(j in b&&b[j]!==k.selected){i[j]=k.selected}});angular.forEach(c.specRange,function(k,j){if(k.min!==k.model_min||k.max!==k.model_max){i[j]=k.model_min+"-"+k.model_max}if(j in b&&(b[j].split("-")[0]!==k.model_min||b[j].split("-")[1]!==k.model_max)){i[j]=k.model_min+"-"+k.model_max}});angular.extend(b,i);h.path(h.path()).search(b)}}})();